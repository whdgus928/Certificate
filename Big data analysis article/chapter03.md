# 3. 빅데이터 모델링
## 3.1 분석 모형 설계
### (1) 분석 모형 선정
1. 교차분석
- 독립변수 종속변수 모두 범주형 자료일때 관계 파악하기 적합
- 남여에 따른 지지정당
2. t-test와 분산분석
- 독립변수 범주형, 종속변수 연속형일때 독립변수의 하부 집단 수가 2집단이면 t-test, 3집단 이상이면 일원배치 분산분석
- a공장과 b공장에서 생산되는 음료의 농도를 비교 : t-test
- 공장이 세 개 이상이면 분산분석
3. 상관관계와 선형회귀분석
- 독립변수 종속변수 모두 연속형 일때
- 매체별 광고횟수와 매출간에 상관이 있는지 파악 
4. 로지스틱 회귀분석과 판별분석
- 정상인과 암 환자 집단의 특징 파악
- 신체 관련 변수, 건강행위 관련 변수중 어떤 변수가 유의한 영향을 미치는지를 파악

#### 머신러닝 기반 모형 선정
1. 지도 학습
- 정답인 레이블이 포함된 학습
- 데이터를 통해 컴퓨터 학습
- 설명변수와 목적변수 간의 관계성을 표현, 미래 관측을 예측
- 인식, 분류, 진단, 예측
- 회귀 : 부모 키를 사용해 딸의 키 예측, 판매량 예측
- 분류 : 예측 값이 실제 값에서 주어진 데이터 범주로 제한, 화물의 정시 도착 여부 예측
- 인공신경망 분석
- 의사결정나무
- 서포트 벡터 머신
- 랜덤 포레스트
- 감성 분석

2. 비지도 학습
- 정답인 레이블 없는 상태
- 데이터가 어떻게 구상되었는지를 파악
- 현상 설명, 특징 도출
- 데이터 마이닝 성격이 강함
- 군집화, 차원축소 기법, 딥러닝
- 연관: 유용한 패턴을 발견, 삼겹살 -> 상추

#### 데이터마이닝 기반 분석모형 선정
1. 분류: 기존의 분류, 정의된 집합에 배정
- 통계적 기법
- 트리기반 기법
- 최적화 기법
- 기계학습
2. 예측
- 회귀분석
- 의사결정나무
- 시계열 분석
- 인공신경망
3. 군집: 미리 정의된 기준x, 유사성에 의해 그룹화
4. 연관
- 장바구니 분석, 마켓팅에서 활용
- 어떤 상품이 같이 판매될 확률이 높은가? 연관된 규칙을 도출
5. 기술: 데이터가 가진 특징 설명

분류|군집
---|---
지도 학습|비지도 학습 
출력 범주 개수 o | 출력 개수 정해져 있지 않다
손글씨 이미지 분류, 학생 교복 사이즈 분류|학생 신체 지수 측정해 키와 몸무게 수집

### (2) 분석모형 정의
변수선정 - 분석기법 선정 - 파라미터(데이터를 통해서 산출 가능) - 하이퍼 파라미터(사용자가 직접 설정해주는 값) - 데이터 선정 및 분할

### (3) 분석모형 구축 절차
1. 요건 정의
2. 데이터 분석 모델링
- 모델링 마트 설계
- 탐색적 분석
- 모델링
- 성능 평가
3. 검증 및 테스트
4. 적용

### (1) 분석 도구 선정
- Scikit learn : 머신러닝
- TensorFlow: 딥러닝 모형

### (2) 데이터 분할
- 데이터를 분할해 훈련 - 훈련된 알고리즘 테스트 - 별도의 검증과정
- 일반적 학습 데이터 70~80%
- k-fold(랜덤 교차검증): 

## 3.2 분석기법 적용
### (1) 회귀분석: 원인변수가 결과변수에 영향을 미치는지를 파악
- ex) 소득이 행복에 영향을 미치는가
- 회귀계수: 독립변수가 변화할때 종속변수가 변화하는 정도, 기울기
- r제곱: 독립변수가 종속변수를 설명하는 정도
- tvalue: 클수록 유의미
- p: 0.05보다 작으면 유의미
- SSR: 회귀제곱합
- SSE: 오차제곱합
- RMSE: 오차(SSE)의 평균값
- 자기상관: 각 잔차항목이 서로 독립적이어서 서로 영향을 미치면 안 된다
- 정규성: 잔차의 평균은 0이 되어야 한다
- 등분산: 잔차의 크기가 분산이 관측값에 영향을 받아서는 안 된다.

### (2) 로지스틱 회귀분석: 종속변수가 범주형 자료일 경우 적용하는 회귀분석
EX) 소득이 주택소유 여부에 미치는 영향
1. 범주의 확률 변환
2. 오즈로 변환: 어떤 사건이 발생하지 않을 확률 대비 발생할 확률
3. 오즈에 자연로그

#### 결과
1. 회귀계수
2. 우도비 검정
- -2LL은 0에 근접할수록 좋은 모델

### (3) 의사결정나무: 소집단으로 분류, 예측
- 지도학습 기법
- 장점: 직관적이고 이해하기 쉬움, 비모수적 모형, 범주형 수치형 변수 모두 사용 가능
- 단점: 예측 변수 효과 파악하기 어려움, 경계선 부근 오차가 큼,새로운 자료에 대한 예측 불안정
- 이산형 변수: 지니지수, 엔트로피 지수, 카이제곱 통계량 
- 연속형 변수: f통계량, 분산 감소량

### (4) 인공신경망: 여러 선, 여러 단계로 예측과 분류를 하려는 시도
- 입력층 - 은닉층 - 출력층

### (5) 서포트 벡터 머신
- 딥러닝 이전 활용도가 높았던 분류 모델
- svm은 카테고리 기준으로 어느 카테고리에 속할지 판단하는 지도학습적 분류모델
- 데이터 크기 중간 이하, 복잡한 과제에 적합한 머신러닝 기법
- margin: 점들이 포함되지 않은 영역을 최대화해서 카테고리를 분리
- 서포트 벡터: 결정 경계선에 가장 가까이 있는 카테고리 데이터
- 장점: 커널함수를 설계하면 나머지는 자동으로 분류기가 계산
- 단점: 데이터 클수록 시간 소모 up

### (6) 연관성 분석
- x이면 y이다 라는 연관관계를 발견
- 장바구니 분석
- 구매이력 데이터를 토대로 x아이템을 구매하면 y 아이템도 구매할 가능성 높다 예측

### (7) 군집 분석: 개체들의 특성을 대표하는 변수들을 기준으로 몇 개의 그룹으로 세분화
- 비지도 학습
- ex) 성격특성 -> 성격유형 군집 분류
- 연속형 변수만 사용 가능
- k-mean 군집분석: 군집화 속도 빠름, 개체 수 많을 때 적합
- 계층적 군집분석: 속도가 오래걸림

### (1) 범주형 자료 분석:두 개의 범주형 자료 간에 연관성을 파악
#### 교차분석 = 카이제곱 검정
성별에 따라서 지지하는 정당에 차이가 있는지를 검증 -> 교차표를 작성해 상호연관성 파악

1. 관측빈도, 기대빈도 교차표 작성
2. 카이제곱 계산: sum (기대빈도-관측빈도)**2 / 기대빈도
3. 유의확률 도출
- 자유도 n-1 * m-1
- 기준값보다 작으면 대립가설 채택

### (2) 다변량 분석
- 여러 변수들의 관계를 동시에 파악
- 주성분분석: 총분산을 이용, 적은 수의 요인으로 설명력 높이기 위해 측정변수를 감소하는 목적
- 요인분석: 적은 수의 요인으로 축소, 현실적
- 판별분석: 관측대상이 속하게 되는 집단을 예측하는 데에 사용 ex) 부도기업과 건전기업을 판별하는 재무지표는, 환자와 정상인을 판별하는 건강지표는?
- 다차원 척도법: 대상간의 유사성 측도에 근거하여 대상을 다차원의 공간에 위치, 변수 간 유사성을 유클리디언거리로 파악

### (3) 시계열 분석: 변수의 연속적인 관찰치를 토대로 미래 특정 시점의 값을 예측
- 월별, 분기별, 연간 데이터 이용
- 수요예측의 목적

#### 단변량 시계열 분석
1. 지수평활법
- 실현값들에 다른 가중값을 부여
2. ARIMA

### (4) 베이지안 기법: 
#### 베이즈 정리: 두 변수의 사전확률과 사후 확률 사이의 관계를 나타내는 정리
- 조건 1: a,b,c... 등이 각각 서로소여야함
- 조건 2: a,b,c... 을 합집합 했을때 정확히 전체가 되어야함

1. 나이브 베이즈: 데이터가 각 클래스에 속할 특징 확률을 계산하는 조건부 확률 기반의 분류 방법
- 나이브: 예측한 특징이 상호 독립적이라는 가정하여 계산을 단순화
- 베이즈
- 장점: 간단하고 빠름, 잡음과 누락 데이터 처리에 효율적
- 단점: 모든 특징이 동등하게 중요하고, 독립이라는 가정이 잘못된 경우 많음
- 예시: 스팸 필터링, 문서 분류
2. 베이지안 네트워크

### (5) 딥러닝 분석
#### DNN
- full batch: 모든 자료 한 번에 알고리즘에 투입, 빅데이터 실시간에 적합x
- stochastic: 전체 자료를 랜덤으로 추출, 과정이 불안정
- mini batch: 전체 중 일부씩 모델에 투입

#### CNN: 합성곱신경망, 이미지 영상인식 등에 특화된 신경망
- pixel로 변환된 데이터로 행렬 연산
- 컨볼루션 레이어: 입력 이미즈를 변환
- 풀링 레이어: 이미지 차원을 축소, 주변 픽섹을 대표 픽셀로 변환

#### RNN: 시간적 스퀀스 처리가 가능하도록 고안된 DNN, 문자 번역 등 다양한 데이터 처리에 적합

### (6) 비정형 데이터 분석
비정형 데이터: 구조화되지 않은 문자, 음성, 이미지, 영상 데이터

#### 텍스터 마이닝: 비정형 텍스트를 정형 텍스트로 변환하고 패턴을 도출한 후 결과를 평가
텍스트 수집 - 텍스트 전처리 - 텍스트 분석 - 텍스트 시각화




### 앙상블 분석: 여러 개의 분류 모형에 결과를 종합해 설명력 높임
- 과대적합 감소 효과
- bagging : 서로 다른 훈련 데이터 샘플로 훈련, 같은 알고리즘 모델 결합, 병렬로 학습하고 결과 집계, 랜덤 포레스트
- boosting : 여러 모델이 순차적으로 학습, 잘못 학습된 데이터에 가중치 부여, light gbm
- voting : 서로 다른 여러 개 알고리즘 모델 사용
- stacking : 학습 결과를 이용해 학습


### 모형 평가
1. 홀드아웃
- 원천 데이터를 랜덤으로 두 개로 분리
- 훈련 데이터는 다시 훈련과 검증 자료로 나눌 수 있음
- 데이터가 많을 때 사용

2. 교차검증
- 데이터가 충분아지 않을 경우 사용
- 클래스 불균형 데이터에는 부적합
- 반복적으로 성과를 측정하여 그 결과를 평균

3. 붓스트랩
- 자료를 반복 재선정
